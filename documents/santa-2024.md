---
tags:
  - Kaggle
  - 組合せ最適化
  - 焼きなまし法
startdate: 2024-11-22
enddate: 2025-02-01
---
# Santa 2024 - The Perplexity Permutation Puzzle
https://www.kaggle.com/competitions/santa-2024

**全体的な傾向:**

このコンペでは、テキストの並べ替え問題が出題され、perplexityを最小化することが目標でした。上位解法は、主に局所探索法（近傍探索）、シミュレーテッドアニーリング（SA）、ビームサーチなどのメタヒューリスティックアルゴリズムを用いています。初期解の生成方法や、局所最適解からの脱出戦略（キック操作）、そして、問題ごとの特性に合わせたアルゴリズムの調整が重要でした。

**各解法の詳細:**

**2位**

- **アプローチ:**
    1. より低いperplexityを持つ順列を探索するための、解の周囲の順列の局所近傍を定義。
    2. 探索するより良い方向がない場合に、局所最適解から抜け出すためのキック操作。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** 局所探索（近傍探索）、キック操作。
- **テクニック:**
    - **局所近傍探索:** 単語またはフレーズの削除と挿入、2つのフレーズの交換。
    - **キック操作:** 解の一部をスクランブル、単語の移動、順列操作の再試行。
    - **問題固有の戦略:**
        - 問題3: 最後の単語を固定して探索。
        - 問題5: 以前の問題の解を組み合わせて初期解を生成し、カスタムキックを実装。
    - **試行されなかった手法:** Simulated Annealing、Late acceptance hill climbing、分割統治法、Branch and Bound、Multi-Arm Bandit。

**3位**

- **アプローチ:** 候補生成に関連する修正を加えたSimulated Annealing（SA）。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** Simulated Annealing（SA）。
- **テクニック:**
    - **カスタム重み付き候補生成:** スコアに基づいて操作に重みを付ける。単語の重要度をperplexityに基づいて計算。操作のパフォーマンスに基づいて重みを更新。
    - **強化されたSimulated Annealing:** 操作の追跡、同等の最高スコアのテキストの考慮、改善が見られない場合の再選択。
    - **初期テキスト（開始点）:** アルファベット順ソート、ストップワードなどをソート、ランダムな開始点、ソートされた品詞。
    - **2番目のアプローチ:** より多くの操作、周期的冷却、許容エネルギー範囲の制限、異なる開始シーケンス戦略、操作の重み付け。

**4位**

- **アプローチ:** 挿入最適化と局所最適化を繰り返すループ（ILS）。[@daiwakun](https://www.kaggle.com/daiwakun)によるキック付きビームサーチ。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** 局所探索、ビームサーチ、挿入最適化。
- **テクニック:**
    - **挿入最適化:** ランダムに選択された単語をビームサーチで挿入。
    - **局所最適化:** サブセクションのシャッフル、単語の交換、単語の移動などを繰り返す。
    - **発見:** 特定の単語を先頭に配置することの利点、機能語（ストップワード）をまとめて先頭に配置する傾向、内容語のアルファベット順、分割ソート（問題5）、機能語からの「and」の削除（問題5）。

**5位**

- **アプローチ:** 局所探索（Simulated Annealingの変種）と、並列探索によるGPUの効率的な利用。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** Simulated Annealing（SA）の変種、マルチポイントサーチ。
- **テクニック:**
    - **Simulated Annealingの変種:** スコアが改善された解は常に保持。悪化したスコアの解は、グローバルな上限を下回る場合に保持。
    - **マルチポイントサーチ:** N個のSAを並列実行。交叉（crossover）の利用。
    - **移動（近傍生成）:** k-opt、削除 - 挿入、ダブルルートアンドステム。
    - **高速化:** テキストスコアのグローバルキャッシュ。
    - **割引されたperplexity:** 単語シーケンスの先頭付近の変更を重視。移動をプレフィックスに制限、または割引されたスコアを使用。
    - **試行されなかった手法:** 順列行列、ATSP解の計算、強化学習を用いたシーケンス予測。

**7位**

- **アプローチ:** Iterated Local Search（ILS）とSimulated Annealing（SA）を組み合わせ、枝刈りされた距離行列、キャッシュメカニズム、分散並列コンピューティングを活用。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** Simulated Annealing（SA）、Iterated Local Search（ILS）。
- **テクニック:**
    - **Simulated Annealing Search（SA Search）:** 温度低下、近傍探索（挿入、スワップ、ローカルシャッフル）、バッチ近傍探索。
    - **Multi-round Simulated Annealing Search（Repeat SA Search）:** SAの繰り返し適用、早期停止メカニズム。
    - **Iterated Local Search（ILS）:** 大きな摂動（ランダムな位置の単語のシャッフル）。
    - **効率的なスコアキャッシュ:** 辞書による実装、バイナリエンコーディングによるストレージ効率化、msgpackによるディスクアクセス高速化。
    - **枝刈り:** 距離行列（2-gramモデルに基づき初期化、動的に最適化）を用いた候補解の枝刈り。

**9位**

- **アプローチ:** すべての6つのテストケースの解を探索するために、Edge Assembly Crossover（GA-EAX）を使用する遺伝的アルゴリズム。ID=0,1,2では、初期にテストされたSAを使用。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** 遺伝的アルゴリズム（GA）、Edge Assembly Crossover（EAX）、Simulated Annealing（SA）。
- **テクニック:**
    - **GA手順:** SAによる初期世代の作成、EAXによる子の生成、局所探索とSAによる子の改善、次世代の選択を繰り返す。
    - **初期個体と近傍操作:** ランダム初期個体、ストップワードの位置、アルファベット順ソートなどを利用。ランダム3-optなどの近傍探索。
    - **EAXによる子の生成と選択:** ロジットを利用したエッジ選択、親との比較による改善された子の選択。多様性を維持するためのペナルティ。

**10位**

- **アプローチ:** Simulated Annealing（SA）のみを使用。良好な結果を得るための鍵は、SAの開始文の実験と適切な選択、SAの十分な理解と制御、計算リソース。
- **アーキテクチャ:** 特定のアーキテクチャの記述はありません。
- **アルゴリズム:** Simulated Annealing（SA）。
- **テクニック:**
    - **SAの開始文の実験と選択:** ストップワードの配置、アルファベット順ソートなどを利用。
    - **SAの理解と制御:** 近傍の生成（単語のスワップ、挿入）、SAのパラメータ調整（初期温度、最終温度、冷却スケジュールなど）、受理率の監視。
    - **SAの実行タイプ:** 高温探索、ウォームアップ実行、低温探索。